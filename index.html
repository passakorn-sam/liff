<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>HTML form to Google Sheet</title>
</head>
<body>
  <h1 id="msg"></h1>
  
  <form>
    <input type="text" name="name" placeholder='Name'><br><br>
    <input type="email" name="email" placeholder='Email'><br><br>
    <input type="tel" name="phone" placeholder='Phone'><br><br>
    <input type="hidden" name="userId" id="userIdInput">
    <input type="hidden" name="displayName" id="displayNameInput">
    <input type="submit" id="sub">
  </form>
  
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
  <script>
    function updateFormWithUserInfo(profile) {
      document.querySelector("#userIdInput").value = profile.userId;
      document.querySelector("#displayNameInput").value = profile.displayName;
    }

    async function main() {
      liff.ready.then(async () => {
        if (liff.isLoggedIn()) {
          const profile = await liff.getProfile();
          updateFormWithUserInfo(profile);
        }
      });

      let form = document.querySelector("form");
      form.addEventListener('submit', (e) => {
        e.preventDefault();
        document.querySelector("#sub").value = "Submitting..";
        let data = new FormData(form);
        fetch('https://script.google.com/macros/s/AKfycbwDJETZHk5XlkIixiX_6nmikj3_nZLkObhyrq3PF5YW0tRbHIi1OLMPWr7FWlbUll-4XQ/exec', {
            method: "POST",
            body: data
        })
        .then(res => res.text())
        .then(data => {
            document.querySelector("#msg").innerHTML = data;
            document.querySelector("#sub").value = "Submit"
        });
      });
    }
    
    main();
  </script>
</body>
</html>
